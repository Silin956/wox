/*!
 * Wox.js v2.0.10
 * (c) 2018-2019 Evio Shen
 * Released under the MIT License.
 */
"use strict";function t(t){return t&&"object"==typeof t&&"default"in t?t.default:t}Object.defineProperty(exports,"__esModule",{value:!0});var e,r=t(require("@babel/runtime/regenerator")),n=t(require("@babel/runtime/helpers/asyncToGenerator")),i=t(require("@babel/runtime/helpers/classCallCheck")),s=t(require("@babel/runtime/helpers/createClass")),a=t(require("@babel/runtime/helpers/possibleConstructorReturn")),o=t(require("@babel/runtime/helpers/assertThisInitialized")),u=t(require("@babel/runtime/helpers/getPrototypeOf")),c=t(require("@babel/runtime/helpers/get")),h=t(require("@babel/runtime/helpers/inherits")),p=t(require("@babel/runtime/helpers/typeof")),f=t(require("@babel/runtime/helpers/wrapNativeSuper")),l=t(require("@babel/runtime/helpers/toConsumableArray")),v=t(require("vue"));!function(t){!function(e){var r="object"==typeof global?global:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),n=i(t);function i(t,e){return function(r,n){"function"!=typeof t[r]&&Object.defineProperty(t,r,{configurable:!0,writable:!0,value:n}),e&&e(r,n)}}void 0===r.Reflect?r.Reflect=t:n=i(r.Reflect,n),function(t){var e=Object.prototype.hasOwnProperty,r="function"==typeof Symbol,n=r&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",i=r&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",s="function"==typeof Object.create,a={__proto__:[]}instanceof Array,o=!s&&!a,u={create:s?function(){return P(Object.create(null))}:a?function(){return P({__proto__:null})}:function(){return P({})},has:o?function(t,r){return e.call(t,r)}:function(t,e){return e in t},get:o?function(t,r){return e.call(t,r)?t[r]:void 0}:function(t,e){return t[e]}},c=Object.getPrototypeOf(Function),h="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,p=h||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?function(){var t={},e=[],r=function(){function t(t,e,r){this._index=0,this._keys=t,this._values=e,this._selector=r}return t.prototype["@@iterator"]=function(){return this},t.prototype[i]=function(){return this},t.prototype.next=function(){var t=this._index;if(t>=0&&t<this._keys.length){var r=this._selector(this._keys[t],this._values[t]);return t+1>=this._keys.length?(this._index=-1,this._keys=e,this._values=e):this._index++,{value:r,done:!1}}return{value:void 0,done:!0}},t.prototype.throw=function(t){throw this._index>=0&&(this._index=-1,this._keys=e,this._values=e),t},t.prototype.return=function(t){return this._index>=0&&(this._index=-1,this._keys=e,this._values=e),{value:t,done:!0}},t}();return function(){function e(){this._keys=[],this._values=[],this._cacheKey=t,this._cacheIndex=-2}return Object.defineProperty(e.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),e.prototype.has=function(t){return this._find(t,!1)>=0},e.prototype.get=function(t){var e=this._find(t,!1);return e>=0?this._values[e]:void 0},e.prototype.set=function(t,e){var r=this._find(t,!0);return this._values[r]=e,this},e.prototype.delete=function(e){var r=this._find(e,!1);if(r>=0){for(var n=this._keys.length,i=r+1;i<n;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,e===this._cacheKey&&(this._cacheKey=t,this._cacheIndex=-2),!0}return!1},e.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=t,this._cacheIndex=-2},e.prototype.keys=function(){return new r(this._keys,this._values,n)},e.prototype.values=function(){return new r(this._keys,this._values,s)},e.prototype.entries=function(){return new r(this._keys,this._values,a)},e.prototype["@@iterator"]=function(){return this.entries()},e.prototype[i]=function(){return this.entries()},e.prototype._find=function(t,e){return this._cacheKey!==t&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=t)),this._cacheIndex<0&&e&&(this._cacheIndex=this._keys.length,this._keys.push(t),this._values.push(void 0)),this._cacheIndex},e}();function n(t,e){return t}function s(t,e){return e}function a(t,e){return[t,e]}}():Map,f=h||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?function(){function t(){this._map=new p}return Object.defineProperty(t.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),t.prototype.has=function(t){return this._map.has(t)},t.prototype.add=function(t){return this._map.set(t,t),this},t.prototype.delete=function(t){return this._map.delete(t)},t.prototype.clear=function(){this._map.clear()},t.prototype.keys=function(){return this._map.keys()},t.prototype.values=function(){return this._map.values()},t.prototype.entries=function(){return this._map.entries()},t.prototype["@@iterator"]=function(){return this.keys()},t.prototype[i]=function(){return this.keys()},t}():Set,l=new(h||"function"!=typeof WeakMap?function(){var t=16,r=u.create(),n=i();return function(){function t(){this._key=i()}return t.prototype.has=function(t){var e=s(t,!1);return void 0!==e&&u.has(e,this._key)},t.prototype.get=function(t){var e=s(t,!1);return void 0!==e?u.get(e,this._key):void 0},t.prototype.set=function(t,e){var r=s(t,!0);return r[this._key]=e,this},t.prototype.delete=function(t){var e=s(t,!1);return void 0!==e&&delete e[this._key]},t.prototype.clear=function(){this._key=i()},t}();function i(){var t;do{t="@@WeakMap@@"+o()}while(u.has(r,t));return r[t]=!0,t}function s(t,r){if(!e.call(t,n)){if(!r)return;Object.defineProperty(t,n,{value:u.create()})}return t[n]}function a(t,e){for(var r=0;r<e;++r)t[r]=255*Math.random()|0;return t}function o(){var e=function(t){if("function"==typeof Uint8Array)return"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(t)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(t)):a(new Uint8Array(t),t);return a(new Array(t),t)}(t);e[6]=79&e[6]|64,e[8]=191&e[8]|128;for(var r="",n=0;n<t;++n){var i=e[n];4!==n&&6!==n&&8!==n||(r+="-"),i<16&&(r+="0"),r+=i.toString(16).toLowerCase()}return r}}():WeakMap);function v(t,e,r){var n=l.get(t);if(_(n)){if(!r)return;n=new p,l.set(t,n)}var i=n.get(e);if(_(i)){if(!r)return;i=new p,n.set(e,i)}return i}function d(t,e,r){var n=v(e,r,!1);return!_(n)&&!!n.has(t)}function y(t,e,r){var n=v(e,r,!1);if(!_(n))return n.get(t)}function m(t,e,r,n){var i=v(r,n,!0);i.set(t,e)}function w(t,e){var r=[],n=v(t,e,!1);if(_(n))return r;for(var s=n.keys(),a=function(t){var e=R(t,i);if(!j(e))throw new TypeError;var r=e.call(t);if(!k(r))throw new TypeError;return r}(s),o=0;;){var u=$(a);if(!u)return r.length=o,r;var c=u.value;try{r[o]=c}catch(t){try{A(a)}finally{throw t}}o++}}function g(t){if(null===t)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===t?1:6;default:return 6}}function _(t){return void 0===t}function x(t){return null===t}function k(t){return"object"==typeof t?null!==t:"function"==typeof t}function b(t,e){switch(g(t)){case 0:case 1:case 2:case 3:case 4:case 5:return t}var r=3===e?"string":5===e?"number":"default",i=R(t,n);if(void 0!==i){var s=i.call(t,r);if(k(s))throw new TypeError;return s}return function(t,e){if("string"===e){var r=t.toString;if(j(r)){var n=r.call(t);if(!k(n))return n}var i=t.valueOf;if(j(i)){var n=i.call(t);if(!k(n))return n}}else{var i=t.valueOf;if(j(i)){var n=i.call(t);if(!k(n))return n}var s=t.toString;if(j(s)){var n=s.call(t);if(!k(n))return n}}throw new TypeError}(t,"default"===r?"number":r)}function E(t){var e=b(t,3);return"symbol"==typeof e?e:function(t){return""+t}(e)}function O(t){return Array.isArray?Array.isArray(t):t instanceof Object?t instanceof Array:"[object Array]"===Object.prototype.toString.call(t)}function j(t){return"function"==typeof t}function q(t){return"function"==typeof t}function R(t,e){var r=t[e];if(null!=r){if(!j(r))throw new TypeError;return r}}function $(t){var e=t.next();return!e.done&&e}function A(t){var e=t.return;e&&e.call(t)}function C(t){var e=Object.getPrototypeOf(t);if("function"!=typeof t||t===c)return e;if(e!==c)return e;var r=t.prototype,n=r&&Object.getPrototypeOf(r);if(null==n||n===Object.prototype)return e;var i=n.constructor;return"function"!=typeof i?e:i===t?e:i}function P(t){return t.__=void 0,delete t.__,t}t("decorate",function(t,e,r,n){if(_(r)){if(!O(t))throw new TypeError;if(!q(e))throw new TypeError;return function(t,e){for(var r=t.length-1;r>=0;--r){var n=t[r],i=n(e);if(!_(i)&&!x(i)){if(!q(i))throw new TypeError;e=i}}return e}(t,e)}if(!O(t))throw new TypeError;if(!k(e))throw new TypeError;if(!k(n)&&!_(n)&&!x(n))throw new TypeError;return x(n)&&(n=void 0),r=E(r),function(t,e,r,n){for(var i=t.length-1;i>=0;--i){var s=t[i],a=s(e,r,n);if(!_(a)&&!x(a)){if(!k(a))throw new TypeError;n=a}}return n}(t,e,r,n)}),t("metadata",function(t,e){return function(r,n){if(!k(r))throw new TypeError;if(!_(n)&&!function(t){switch(g(t)){case 3:case 4:return!0;default:return!1}}(n))throw new TypeError;m(t,e,r,n)}}),t("defineMetadata",function(t,e,r,n){if(!k(r))throw new TypeError;_(n)||(n=E(n));return m(t,e,r,n)}),t("hasMetadata",function(t,e,r){if(!k(e))throw new TypeError;_(r)||(r=E(r));return function t(e,r,n){var i=d(e,r,n);if(i)return!0;var s=C(r);if(!x(s))return t(e,s,n);return!1}(t,e,r)}),t("hasOwnMetadata",function(t,e,r){if(!k(e))throw new TypeError;_(r)||(r=E(r));return d(t,e,r)}),t("getMetadata",function(t,e,r){if(!k(e))throw new TypeError;_(r)||(r=E(r));return function t(e,r,n){var i=d(e,r,n);if(i)return y(e,r,n);var s=C(r);if(!x(s))return t(e,s,n);return}(t,e,r)}),t("getOwnMetadata",function(t,e,r){if(!k(e))throw new TypeError;_(r)||(r=E(r));return y(t,e,r)}),t("getMetadataKeys",function(t,e){if(!k(t))throw new TypeError;_(e)||(e=E(e));return function t(e,r){var n=w(e,r);var i=C(e);if(null===i)return n;var s=t(i,r);if(s.length<=0)return n;if(n.length<=0)return s;var a=new f;var o=[];for(var u=0,c=n;u<c.length;u++){var h=c[u],p=a.has(h);p||(a.add(h),o.push(h))}for(var l=0,v=s;l<v.length;l++){var h=v[l],p=a.has(h);p||(a.add(h),o.push(h))}return o}(t,e)}),t("getOwnMetadataKeys",function(t,e){if(!k(t))throw new TypeError;_(e)||(e=E(e));return w(t,e)}),t("deleteMetadata",function(t,e,r){if(!k(e))throw new TypeError;_(r)||(r=E(r));var n=v(e,r,!1);if(_(n))return!1;if(!n.delete(t))return!1;if(n.size>0)return!0;var i=l.get(e);if(i.delete(r),i.size>0)return!0;return l.delete(e),!0})}(n)}()}(e||(e={}));var d=["Get","Post","Put","Delete"],y={},m={};d.forEach(function(t){y[t]=function(e,r,n){if("string"==typeof e)return function(r,n,i){var s=Reflect.getMetadata("Http",i.value);s||(s=[]),s.unshift({method:t,prefix:e}),Reflect.defineMetadata("Http",s,i.value)};var i=Reflect.getMetadata("Http",n.value);i||(i=[]),i.unshift({method:t,prefix:"(/)?"}),Reflect.defineMetadata("Http",i,n.value)}});var w=function(){function t(){i(this,t),this._eventStacks={}}return s(t,null,[{key:"Methods",get:function(){return["on","off","addListener","removeListener","prependListener","removeAllListeners","emit","eventNames","listenerCount","listeners"]}}]),s(t,[{key:"on",value:function(t,e){this.addListener(t,e)}},{key:"off",value:function(t,e){this.removeListener(t,e)}},{key:"addListener",value:function(t,e){this._eventStacks[t]||(this._eventStacks[t]=[]),this._eventStacks[t].push(e)}},{key:"removeListener",value:function(t,e){var r=this.listeners(t),n=r.indexOf(e);n>-1&&(r.splice(n,1),0===this.listenerCount(t)&&this.removeAllListeners(t))}},{key:"prependListener",value:function(t,e){this._eventStacks[t]||(this._eventStacks[t]=[]),this._eventStacks[t].unshift(e)}},{key:"removeAllListeners",value:function(t){this._eventStacks[t]&&delete this._eventStacks[t]}},{key:"emit",value:function(){var t=n(r.mark(function t(e){var n,i,s,a,o,u,c=arguments;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.listeners(e)){t.next=3;break}return t.abrupt("return");case 3:for(i=c.length,s=new Array(i>1?i-1:0),a=1;a<i;a++)s[a-1]=c[a];o=0;case 5:if(!(o<n.length)){t.next=12;break}return u=n[o],t.next=9,u.apply(void 0,s);case 9:o++,t.next=5;break;case 12:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"eventNames",value:function(){return Object.keys(this._eventStacks)}},{key:"listenerCount",value:function(t){var e=this.listeners(t);return e?e.length:0}},{key:"listeners",value:function(t){return this._eventStacks[t]}}]),t}(),g={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"===p(t)&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}},_=T;function x(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var k=/^([a-z0-9.+-]+:)/i,b=/:[0-9]*$/,E=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,O=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),j=["'"].concat(O),q=["%","/","?",";","#"].concat(j),R=["/","?","#"],$=/^[+a-z0-9A-Z_-]{0,63}$/,A=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,C={javascript:!0,"javascript:":!0},P={javascript:!0,"javascript:":!0},M={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},S=require("querystring");function T(t,e,r){if(t&&g.isObject(t)&&t instanceof x)return t;var n=new x;return n.parse(t,e,r),n}x.prototype.parse=function(t,e,r){if(!g.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+p(t));var n=t.indexOf("?"),i=-1!==n&&n<t.indexOf("#")?"?":"#",s=t.split(i);s[0]=s[0].replace(/\\/g,"/");var a=t=s.join(i);if(a=a.trim(),!r&&1===t.split("#").length){var o=E.exec(a);if(o)return this.path=a,this.href=a,this.pathname=o[1],o[2]?(this.search=o[2],this.query=e?S.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var u=k.exec(a);if(u){var c=(u=u[0]).toLowerCase();this.protocol=c,a=a.substr(u.length)}if(r||u||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var h="//"===a.substr(0,2);!h||u&&P[u]||(a=a.substr(2),this.slashes=!0)}if(!P[u]&&(h||u&&!M[u])){for(var f,l,v=-1,d=0;d<R.length;d++){-1!==(y=a.indexOf(R[d]))&&(-1===v||y<v)&&(v=y)}-1!==(l=-1===v?a.lastIndexOf("@"):a.lastIndexOf("@",v))&&(f=a.slice(0,l),a=a.slice(l+1),this.auth=decodeURIComponent(f)),v=-1;for(d=0;d<q.length;d++){var y;-1!==(y=a.indexOf(q[d]))&&(-1===v||y<v)&&(v=y)}-1===v&&(v=a.length),this.host=a.slice(0,v),a=a.slice(v),this.parseHost(),this.hostname=this.hostname||"";var m="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!m)for(var w=this.hostname.split(/\./),_=(d=0,w.length);d<_;d++){var x=w[d];if(x&&!x.match($)){for(var b="",O=0,T=x.length;O<T;O++)x.charCodeAt(O)>127?b+="x":b+=x[O];if(!b.match($)){var I=w.slice(0,d),L=w.slice(d+1),N=x.match(A);N&&(I.push(N[1]),L.unshift(N[2])),L.length&&(a="/"+L.join(".")+a),this.hostname=I.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase();var D=this.port?":"+this.port:"",U=this.hostname||"";this.host=U+D,this.href+=this.host,m&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==a[0]&&(a="/"+a))}if(!C[c])for(d=0,_=j.length;d<_;d++){var W=j[d];if(-1!==a.indexOf(W)){var H=encodeURIComponent(W);H===W&&(H=escape(W)),a=a.split(W).join(H)}}var V=a.indexOf("#");-1!==V&&(this.hash=a.substr(V),a=a.slice(0,V));var z=a.indexOf("?");if(-1!==z?(this.search=a.substr(z),this.query=a.substr(z+1),e&&(this.query=S.parse(this.query)),a=a.slice(0,z)):e&&(this.search="",this.query={}),a&&(this.pathname=a),M[c]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){D=this.pathname||"";var G=this.search||"";this.path=D+G}return this.href=this.format(),this},x.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",r=this.pathname||"",n=this.hash||"",i=!1,s="";this.host?i=t+this.host:this.hostname&&(i=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&g.isObject(this.query)&&Object.keys(this.query).length&&(s=S.stringify(this.query));var a=this.search||s&&"?"+s||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||M[e])&&!1!==i?(i="//"+(i||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):i||(i=""),n&&"#"!==n.charAt(0)&&(n="#"+n),a&&"?"!==a.charAt(0)&&(a="?"+a),e+i+(r=r.replace(/[?#]/g,function(t){return encodeURIComponent(t)}))+(a=a.replace("#","%23"))+n},x.prototype.resolve=function(t){return this.resolveObject(T(t,!1,!0)).format()},x.prototype.resolveObject=function(t){if(g.isString(t)){var e=new x;e.parse(t,!1,!0),t=e}for(var r=new x,n=Object.keys(this),i=0;i<n.length;i++){var s=n[i];r[s]=this[s]}if(r.hash=t.hash,""===t.href)return r.href=r.format(),r;if(t.slashes&&!t.protocol){for(var a=Object.keys(t),o=0;o<a.length;o++){var u=a[o];"protocol"!==u&&(r[u]=t[u])}return M[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(t.protocol&&t.protocol!==r.protocol){if(!M[t.protocol]){for(var c=Object.keys(t),h=0;h<c.length;h++){var p=c[h];r[p]=t[p]}return r.href=r.format(),r}if(r.protocol=t.protocol,t.host||P[t.protocol])r.pathname=t.pathname;else{for(var f=(t.pathname||"").split("/");f.length&&!(t.host=f.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==f[0]&&f.unshift(""),f.length<2&&f.unshift(""),r.pathname=f.join("/")}if(r.search=t.search,r.query=t.query,r.host=t.host||"",r.auth=t.auth,r.hostname=t.hostname||t.host,r.port=t.port,r.pathname||r.search){var l=r.pathname||"",v=r.search||"";r.path=l+v}return r.slashes=r.slashes||t.slashes,r.href=r.format(),r}var d=r.pathname&&"/"===r.pathname.charAt(0),y=t.host||t.pathname&&"/"===t.pathname.charAt(0),m=y||d||r.host&&t.pathname,w=m,_=r.pathname&&r.pathname.split("/")||[],k=(f=t.pathname&&t.pathname.split("/")||[],r.protocol&&!M[r.protocol]);if(k&&(r.hostname="",r.port=null,r.host&&(""===_[0]?_[0]=r.host:_.unshift(r.host)),r.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===f[0]?f[0]=t.host:f.unshift(t.host)),t.host=null),m=m&&(""===f[0]||""===_[0])),y)r.host=t.host||""===t.host?t.host:r.host,r.hostname=t.hostname||""===t.hostname?t.hostname:r.hostname,r.search=t.search,r.query=t.query,_=f;else if(f.length)_||(_=[]),_.pop(),_=_.concat(f),r.search=t.search,r.query=t.query;else if(!g.isNullOrUndefined(t.search)){if(k)r.hostname=r.host=_.shift(),(q=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=q.shift(),r.host=r.hostname=q.shift());return r.search=t.search,r.query=t.query,g.isNull(r.pathname)&&g.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!_.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var b=_.slice(-1)[0],E=(r.host||t.host||_.length>1)&&("."===b||".."===b)||""===b,O=0,j=_.length;j>=0;j--)"."===(b=_[j])?_.splice(j,1):".."===b?(_.splice(j,1),O++):O&&(_.splice(j,1),O--);if(!m&&!w)for(;O--;O)_.unshift("..");!m||""===_[0]||_[0]&&"/"===_[0].charAt(0)||_.unshift(""),E&&"/"!==_.join("/").substr(-1)&&_.push("");var q,R=""===_[0]||_[0]&&"/"===_[0].charAt(0);k&&(r.hostname=r.host=R?"":_.length?_.shift():"",(q=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=q.shift(),r.host=r.hostname=q.shift()));return(m=m||r.host&&_.length)&&!R&&_.unshift(""),_.length?r.pathname=_.join("/"):(r.pathname=null,r.path=null),g.isNull(r.pathname)&&g.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=t.auth||r.auth,r.slashes=r.slashes||t.slashes,r.href=r.format(),r},x.prototype.parseHost=function(){var t=this.host,e=b.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)};var I=function(){function t(e){i(this,t),this.history=e}return s(t,[{key:"redirect",value:function(){var t=n(r.mark(function t(){var e,n=arguments;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(e=this.history).redirect.apply(e,n);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"replace",value:function(){var t=n(r.mark(function t(){var e,n=arguments;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(e=this.history).replace.apply(e,n);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"reload",value:function(){var t=n(r.mark(function t(){return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.history.reload();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}]),t}(),L={hash:"hashchange",html5:"popstate"},N=function(t){function e(t){var r;return i(this,e),(r=a(this,u(e).call(this))).history_installed=!1,r.history_process_listener=null,r.history_stop_run_process=!1,r.history_event_name=L[t]||"hashChange","html5"!==t||window.history.pushState||(r.history_event_name=L.hash),r}return h(e,w),s(e,[{key:"history_create_context",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=function(e,r){return t.history_stop_run_process=!1,r},n=this.history_parse(e.url);return n.body=e.body,n.isapi=!!e.url,n.method=e.method?e.method.toUpperCase():"GET",n.isapi||(n.referer=this.history_referer,r=function(e,r){return e||(t.history_referer=n.href),t.history_stop_run_process=!1,r}),{next:r,request:n,response:new I(this)}}},{key:"history_parse",value:function(t){switch(this.history_event_name){case L.html5:return _(t?window.location.origin+t:window.location.href,!0);default:var e=window.location,r=t&&"#"!==t.charAt(0)?"#"+t:e.hash,n=_(r.length?r.substr(1):"/",!0);return n.host=e.host,n.hostname=e.hostname,n.port=e.port,n.protocol=e.protocol,n}}},{key:"history_create_server",value:function(t){this.history_process_listener=t}},{key:"history_listen",value:function(){var t=this,e=function(){t.history_stop_run_process||t.history_run_process()};return window.addEventListener(this.history_event_name,e),this.history_installed=!0,function(){return window.removeEventListener(t.history_event_name,e)}}},{key:"history_run_process",value:function(){var t=n(r.mark(function t(e){var n,i,s,a;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.history_create_context(e),i=n.request,s=n.response,a=n.next,t.next=3,this.history_process_listener(i,s,a);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"redirect",value:function(){var t=n(r.mark(function t(e,n){var i;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=this.history_event_name,t.next=t.t0===L.html5?3:16;break;case 3:if(!n){t.next=11;break}return this.history_stop_run_process=!0,t.next=7,this.history_run_process({url:e});case 7:i=t.sent,window.history.pushState({},window.document.title,e),t.next=15;break;case 11:return window.history.pushState({},window.document.title,e),t.next=14,this.reload();case 14:i=t.sent;case 15:return t.abrupt("break",27);case 16:if(!n){t.next=23;break}return t.next=19,this.history_run_process({url:e});case 19:i=t.sent,window.location.hash=e,t.next=27;break;case 23:return window.location.hash=e,t.next=26,this.reload();case 26:i=t.sent;case 27:return t.abrupt("return",i);case 28:case"end":return t.stop()}},t,this)}));return function(e,r){return t.apply(this,arguments)}}()},{key:"replace",value:function(){var t=n(r.mark(function t(e,n){var i;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=this.history_event_name,t.next=t.t0===L.html5?3:16;break;case 3:if(!n){t.next=11;break}return this.history_stop_run_process=!0,t.next=7,this.history_run_process({url:e});case 7:i=t.sent,window.history.replaceState({},window.document.title,e),t.next=15;break;case 11:return window.history.replaceState({},window.document.title,e),t.next=14,this.reload();case 14:i=t.sent;case 15:return t.abrupt("break",27);case 16:if(!n){t.next=23;break}return t.next=19,this.history_run_process({url:e});case 19:i=t.sent,D(e),t.next=27;break;case 23:return D(e),t.next=26,this.reload();case 26:i=t.sent;case 27:return t.abrupt("return",i);case 28:case"end":return t.stop()}},t,this)}));return function(e,r){return t.apply(this,arguments)}}()},{key:"reload",value:function(){var t=n(r.mark(function t(){return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.history_run_process();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"history_url_render",value:function(t){if(t)switch(this.history_stop_run_process=!0,this.history_event_name){case L.html5:window.history.replaceState({},window.document.title,t);break;default:D(t)}}}]),e}();function D(t){var e=window.location.href.indexOf("#");window.location.replace(window.location.href.slice(0,e>=0?e:0)+"#"+t)}function U(t,e){if(!(this instanceof U))return new U(t,e);this.proto=t,this.target=e,this.methods=[],this.getters=[],this.setters=[],this.fluents=[]}U.prototype.method=function(t){var e=this.proto,r=this.target;return this.methods.push(t),e[t]=function(){return this[r][t].apply(this[r],arguments)},this},U.prototype.access=function(t){return this.getter(t).setter(t)},U.prototype.getter=function(t){var e=this.proto,r=this.target;return this.getters.push(t),e.__defineGetter__(t,function(){return this[r][t]}),this},U.prototype.setter=function(t){var e=this.proto,r=this.target;return this.setters.push(t),e.__defineSetter__(t,function(e){return this[r][t]=e}),this},U.prototype.fluent=function(t){var e=this.proto,r=this.target;return this.fluents.push(t),e[t]=function(e){return void 0!==e?(this[r][t]=e,this):this[r][t]},this};var W=function(t){function e(t,r){var n;return i(this,e),(n=a(this,u(e).call(this,"[Wox Error]: "+t))).status=r||500,n.code=r||500,n}return h(e,t),e}(f(Error)),H={error:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;return new W(t instanceof Error?t.message:t,e)},render:function(t,e){return this.status=200,this.app.render(t,e)}},V=new U(H,"response"),z=new U(H,"request");V.method("redirect").method("replace").method("reload").method("fetch").method("get").method("post").method("put").method("delete"),z.access("search").access("method").access("query").access("path").access("url").access("body").access("referer").getter("protocol").getter("host").getter("hostname").getter("secure").getter("isapi").access("referer");var G={get url(){return this.req.href},get method(){return this.req.method||"GET"},get path(){return this.req.pathname},get query(){return this.req.query},get search(){return this.req.search},get host(){return this.req.host},get hostname(){return this.req.hostname},get protocol(){return this.req.protocol},get secure(){return"https"===this.protocol},get isapi(){return this.req.isapi},get referer(){return this.req.referer}},K={redirect:function(){var t=n(r.mark(function t(){var e,n=arguments;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(e=this.res).redirect.apply(e,n);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),replace:function(){var t=n(r.mark(function t(){var e,n=arguments;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(e=this.res).replace.apply(e,n);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),reload:function(){var t=n(r.mark(function t(){return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.res.reload();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),fetch:function(){var t=n(r.mark(function t(){var e,n=arguments;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(e=this.app).fetch.apply(e,n);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),get:function(){var t=n(r.mark(function t(){var e,n=arguments;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(e=this.app).get.apply(e,n);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),post:function(){var t=n(r.mark(function t(){var e,n=arguments;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(e=this.app).post.apply(e,n);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),put:function(){var t=n(r.mark(function t(){var e,n=arguments;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(e=this.app).put.apply(e,n);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),delete:function(){var t=n(r.mark(function t(){var e,n=arguments;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(e=this.app).delete.apply(e,n);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()};function F(t){return function(e,r){var n=-1;return function i(s){if(s<=n)return Promise.reject(new W("[compose] next() called multiple times"));n=s;var a=t[s];s===t.length&&(a=r);if(!a)return Promise.resolve();try{return Promise.resolve(a(e,i.bind(null,s+1)))}catch(t){return Promise.reject(t)}}(0)}}var B=function(t){function e(t){var r;return i(this,e),(r=a(this,u(e).call(this,t))).middleware=[],r.context=Object.create(H),r.request=Object.create(G),r.response=Object.create(K),r.contextRequestId=0,r.listener=null,r}return h(e,N),s(e,[{key:"serverCreateContext",value:function(t,e){var r=Object.create(this.context),n=r.request=Object.create(this.request),i=r.response=Object.create(this.response);return r.app=n.app=i.app=this,r.req=n.req=i.req=t,r.res=n.res=i.res=e,n.ctx=i.ctx=r,n.response=i,i.request=n,r.status=404,r.id=(new Date).getTime()+"_"+this.contextRequestId++,this.contextEvents(r)}},{key:"contextEvents",value:function(t){var e=new w;return w.Methods.forEach(function(r){"function"==typeof e[r]&&Object.defineProperty(t,r,{value:e[r].bind(e)})}),t}},{key:"serverHandleRequest",value:function(){var t=n(r.mark(function t(e,n){return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n(e).then(function(){switch(e.isapi?440===e.status&&void 0!==e.body&&(e.status=200):void 0!==e.body&&404===e.status&&(e.status=200),e.status){case 404:return Promise.reject(e.error("Not Find Request Path: "+e.path,404));case 440:if(!e.isapi)return Promise.reject(e.error("No Webview Found On "+e.path,440));case 200:return e.body;default:return Promise.reject(e.error(e.reason||"Unknown Error",e.status))}}).catch(function(t){return t.status||(t.status=500),Promise.reject(t)});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t)}));return function(e,r){return t.apply(this,arguments)}}()},{key:"fetch",value:function(){var t=n(r.mark(function t(n){var i;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.history_installed){t.next=2;break}throw H.error("No history installed",502);case 2:return t.next=4,c(u(e.prototype),"history_run_process",this).call(this,n);case 4:if(!((i=t.sent)instanceof W)){t.next=7;break}throw i;case 7:return t.abrupt("return",i);case 8:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"get",value:function(){var t=n(r.mark(function t(e){return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.fetch({url:e,method:"GET"});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"post",value:function(){var t=n(r.mark(function t(e,n){return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.fetch({url:e,body:n,method:"POST"});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}));return function(e,r){return t.apply(this,arguments)}}()},{key:"put",value:function(){var t=n(r.mark(function t(e,n){return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.fetch({url:e,body:n,method:"PUT"}));case 1:case"end":return t.stop()}},t,this)}));return function(e,r){return t.apply(this,arguments)}}()},{key:"delete",value:function(){var t=n(r.mark(function t(e){return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.fetch({url:e,method:"DELETE"});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"use",value:function(t){return this.middleware.push(t),this}},{key:"createServer",value:function(){var t=n(r.mark(function t(i){var s,a=this;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s=F(this.middleware),c(u(e.prototype),"history_create_server",this).call(this,function(){var t=n(r.mark(function t(e,n,i){var o;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=a.serverCreateContext(e,n),t.next=3,a.emit("start",o);case 3:return t.next=5,a.serverHandleRequest(o,s).then(function(t){return i(null),Promise.all([o.emit("success",t),a.emit("stop",o)]).then(function(){return t})}).catch(function(t){i(t);var e=!1;return t.preventDefault=function(){return e=!0},Promise.all([o.emit("error",t),a.emit("error",t),a.emit("stop",o)]).then(function(){if(!e)return Promise.reject(t)})});case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}},t)}));return function(e,r,n){return t.apply(this,arguments)}}()),this.listener=c(u(e.prototype),"history_listen",this).call(this),t.next=5,c(u(e.prototype),"history_run_process",this).call(this,{url:i});case 5:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"destoryServer",value:function(){this.listener&&this.listener()}}]),e}(),Z=function(){function t(e,r,n){i(this,t),this.app=e,this.name=r,this.dependencies=n,this.container=e.$plugin,e.$plugin.set(r,this),Object.defineProperty(this,"$config",{get:function(){return e.$plugin.getConfig(r)}})}return s(t,[{key:"get",value:function(t){if(-1===this.dependencies.indexOf(t))throw H.error("".concat(t," is not one of ").concat(JSON.stringify(this.dependencies)));return this.app.$plugin.get(t)}},{key:"setDecorate",value:function(t){return this.app.$plugin.setDecorate(t),this}}]),t}(),J=function(){function t(e){i(this,t),this.stacks={},this.configs=e,this.decorates={}}return s(t,[{key:"set",value:function(t,e){return this.stacks[t]=e,this}},{key:"get",value:function(t){return this.stacks[t]}},{key:"getConfig",value:function(t){return this.configs[t]}},{key:"setDecorate",value:function(t){var e=new t;return this.decorates[e.name]=e,this}},{key:"renderDecorateIntoInterface",value:function(){var t=this,e=function(e){var r=t.decorates[e];"function"==typeof r.interfaceWillInject&&(m[e]=function(){return r.interfaceWillInject.apply(r,arguments)})};for(var r in this.decorates)e(r)}}]),t}(),Y={name:"WoxViewPage",computed:{webview:function(){return this.$root.webview},props:function(){return this.$root.props}},created:function(){var t=this;this.$root.$on("enter",function(e){var r=t.$refs.dynamicRenderer;r&&("function"==typeof r.$options.enter&&r.$options.enter.call(r,e),t.$root._virtualModel=r)}),this.$root.$on("leave",function(){var e=t.$root._virtualModel;e&&"function"==typeof e.$options.leave&&e.$options.leave.call(e)})},render:function(t){if(this.webview)return t(this.webview,{props:this.props,ref:"dynamicRenderer"})}},Q=function(){function t(e,r,n){i(this,t),this.app=e,this.el=r,this.name=n,this.url=null,this.sync=!1,this.handle=null}return s(t,[{key:"set",value:function(t,e){this.url=t,this.sync="sync"===e}},{key:"bind",value:function(t,e){var i=this;this.handle=n(r.mark(function t(){return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("function"!=typeof i.app[i.name]){t.next=3;break}return t.next=3,i.app[i.name](i.url,i.sync);case 3:case"end":return t.stop()}},t)})),this.el.addEventListener("click",this.handle),this.set(t,e)}},{key:"unbind",value:function(){this.handle&&this.el.removeEventListener("click",this.handle),this.el.__wox_directive_taqrget__&&delete this.el.__wox_directive_taqrget__}}]),t}(),X=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t),this.configs=e,this.result={}}return s(t,[{key:"render",value:function(){return this.CustomConfigRender(),this.PluginConfigRender(),this.result}},{key:"CustomConfigRender",value:function(){var t=(this.configs.custom_configs||[]).map(function(t){return t.default||t});this.result.custom_configs=Object.assign.apply(Object,[{}].concat(l(t)))}},{key:"PluginConfigRender",value:function(){var t=this.configs.plugin_configs||{};this.result.plugin_configs=t.default||t}},{key:"VueInjectRender",value:function(){var t=this,e=this.configs.component,r=this.configs.directive,n=this.configs.filter,i=this.configs.mixin;e.forEach(function(e){t.ContextEach(e,function(t,e){if(!e.name)throw new W("component miss name option in ".concat(t,"."));v.component(e.name,e)})}),r.forEach(function(e){t.ContextEach(e,function(t,e){var r=t.split("/").slice(-1)[0].split(".").slice(0,-1)[0];v.directive(r,e)})}),n.forEach(function(e){t.ContextEach(e,function(t,e){var r=t.split("/").slice(-1)[0].split(".").slice(0,-1)[0];v.filter(r,e)})}),i.forEach(function(e){t.ContextEach(e,function(t,e){return v.mixin(e)})})}},{key:"ContextEach",value:function(t,e){t.keys().forEach(function(r){var n=t(r).default;e(r,n)})}},{key:"PluginRender",value:function(){var t=n(r.mark(function t(e){var n,i,s,a,o;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=this.configs.bootstrap,i=0;case 2:if(!(i<n.length)){t.next=13;break}if(s=n[i],a=[e],s.name&&a.push(new Z(e,s.name,s.dependencies)),"function"!=typeof(o=s.exports.default||s.exports)){t.next=10;break}return t.next=10,o.apply(void 0,a);case 10:i++,t.next=2;break;case 13:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"ControllerRender",value:function(){for(var t=[],e=this.configs.controller,r=0;r<e.length;r++){var n=e[r];this.ContextEach(n,function(e,r){r._filePath=e,-1===t.indexOf(r)&&t.push(r)})}return t}},{key:"DecorateRender",value:function(t){var e=this;this.configs.decorate.forEach(function(r){e.ContextEach(r,function(e,r){return t.$plugin.setDecorate(r)})})}},{key:"BuildVue",value:function(t){var e,r=this;t.$config.el?e="object"===p(t.$config.el)?t.$config.el:window.document.querySelector(t.$config.el):(e=window.document.createElement("div"),window.document.body.appendChild(e)),["redirect","replace","reload","get","post","put","delete"].forEach(function(t){v.prototype["$"+t]=function(){if("function"==typeof r[t])return r[t].apply(r,arguments)}}),function(t){["redirect","replace","reload"].forEach(function(e){v.directive(e,{bind:function(r,n){var i=new Q(t,r,e);i.bind(n.value,n.arg),r.__wox_directive_taqrget__=i},unbind:function(t){t.__wox_directive_taqrget__&&t.__wox_directive_taqrget__.unbind()},update:function(t,e){t.__wox_directive_taqrget__&&t.__wox_directive_taqrget__.set(e.value,e.arg)},componentUpdated:function(t,e){t.__wox_directive_taqrget__&&t.__wox_directive_taqrget__.set(e.value,e.arg)}})})}(t),v.component("WoxViewPage",Y);var n={webview:null,props:null,installed:!1},i={name:"WoxRuntimeViewModel",data:function(){return n},mounted:function(){this.installed=!0},render:function(t){return r.configs.view?t(r.configs.view.default||r.configs.view):t(Y)}};t.emit("setup",i);var s=new v(i);return t.on("start",function(t){t.isapi||s.$emit("leave",t)}),t.on("stop",function(t){t.isapi||s.$emit("enter",t)}),s.$mount(e),s}}]),t}(),tt="/",et=new RegExp(["(\\\\.)","(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?"].join("|"),"g");function rt(t){return t.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function nt(t){return t.replace(/([=!:$\/()])/g,"\\$1")}function it(t){return t&&t.sensitive?"":"i"}function st(t,e,r){return function(t,e,r){for(var n=(r=r||{}).strict,i=!1!==r.start,s=!1!==r.end,a=r.delimiter||tt,o=[].concat(r.endsWith||[]).map(rt).concat("$").join("|"),u=i?"^":"",c=0;c<t.length;c++){var h=t[c];if("string"==typeof h)u+=rt(h);else{var p=h.repeat?"(?:"+h.pattern+")(?:"+rt(h.delimiter)+"(?:"+h.pattern+"))*":h.pattern;e&&e.push(h),h.optional?h.prefix?u+="(?:"+rt(h.prefix)+"("+p+"))?":u+="("+p+")?":u+=rt(h.prefix)+"("+p+")"}}if(s)n||(u+="(?:"+rt(a)+")?"),u+="$"===o?"$":"(?="+o+")";else{var f=t[t.length-1],l="string"==typeof f?f[f.length-1]===a:void 0===f;n||(u+="(?:"+rt(a)+"(?="+o+"))?"),l||(u+="(?="+rt(a)+"|"+o+")")}return new RegExp(u,it(r))}(function(t,e){for(var r,n=[],i=0,s=0,a="",o=e&&e.delimiter||tt,u=e&&e.whitelist||void 0,c=!1;null!==(r=et.exec(t));){var h=r[0],p=r[1],f=r.index;if(a+=t.slice(s,f),s=f+h.length,p)a+=p[1],c=!0;else{var l="",v=r[2],d=r[3],y=r[4],m=r[5];if(!c&&a.length){var w=a.length-1,g=a[w];(!u||u.indexOf(g)>-1)&&(l=g,a=a.slice(0,w))}a&&(n.push(a),a="",c=!1);var _="+"===m||"*"===m,x="?"===m||"*"===m,k=d||y,b=l||o;n.push({name:v||i++,prefix:l,delimiter:b,optional:x,repeat:_,pattern:k?nt(k):"[^"+rt(b===o?b:b+o)+"]+?"})}}return(a||s<t.length)&&n.push(a+t.substr(s)),n}(t,r),e,r)}function at(t,e,r){return t instanceof RegExp?function(t,e){if(!e)return t;var r=t.source.match(/\((?!\?)/g);if(r)for(var n=0;n<r.length;n++)e.push({name:n,prefix:null,delimiter:null,optional:!1,repeat:!1,pattern:null});return t}(t,e):Array.isArray(t)?function(t,e,r){for(var n=[],i=0;i<t.length;i++)n.push(at(t[i],e,r).source);return new RegExp("(?:"+n.join("|")+")",it(r))}(t,e,r):st(t,e,r)}function ot(t,e,r,n){this.opts=n||{},this.name=this.opts.name||null,this.methods=[],this.paramNames=[],this.stack=Array.isArray(r)?r:[r],e.forEach(function(t){var e=this.methods.push(t.toUpperCase());"GET"===this.methods[e-1]&&this.methods.unshift("HEAD")},this),this.stack.forEach(function(r){var n=p(r);if("function"!==n)throw new Error(e.toString()+" `"+(this.opts.name||t)+"`: `middleware` must be a function, not `"+n+"`")},this),this.path=t,this.regexp=at(t,this.paramNames,this.opts)}function ut(t){try{return decodeURIComponent(t)}catch(e){return t}}function ct(t){if(!(this instanceof ct))return new ct(t);this.opts=t||{},this.methods=this.opts.methods||["GET"],this.params={},this.stack=[]}function ht(t,e){var i=t.$plugin.decorates;e.slice(0).sort(function(t,e){return(Reflect.getOwnMetadata("Index",t)||0)-(Reflect.getOwnMetadata("Index",e)||0)}).forEach(function(e){var s,a=Reflect.getMetadata("Controller",e),o=new ct,u=Reflect.getMetadata("Middleware",e)||[];(Reflect.getMetadata("Param",e)||[]).forEach(function(t){return o.param.apply(o,[t.id].concat(l(t.middlewares)))});for(var c=Object.getOwnPropertyNames(e.prototype),h=function(t){var s=c[t];if("constructor"===s)return"continue";var a=Reflect.getOwnMetadata("Middleware",e.prototype[s])||[],u=Reflect.getOwnMetadata("Http",e.prototype[s]),h={};for(var p in i){var f=i[p].get(e.prototype[s]);void 0!==f&&(h[p]={value:f,target:i[p]})}u&&u.forEach(function(t){var i=a.slice(0);i.push(function(){var t=n(r.mark(function t(n,i){var a,o,u,c,p,f;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(u in n.status=440,(a=new e(n)).ctx||Object.defineProperty(a,"ctx",{get:function(){return n}}),o={},h)c=h[u].target,p=h[u].value,"function"==typeof c.interfaceDidRendered&&c.interfaceDidRendered(p,{options:o,ctx:n});return t.next=7,a[s].call(a,o);case 7:void 0!==(f=t.sent)&&(n.body=f);case 9:case"end":return t.stop()}},t)}));return function(e,r){return t.apply(this,arguments)}}()),o[t.method.toLowerCase()].apply(o,[t.prefix].concat(l(i)))})},p=0;p<c.length;p++)h(p);(s=t.$router).use.apply(s,[a].concat(l(u),[o.routes()]))})}ot.prototype.match=function(t){return this.regexp.test(t)},ot.prototype.params=function(t,e,r){for(var n=r||{},i=e.length,s=0;s<i;s++)if(this.paramNames[s]){var a=e[s];n[this.paramNames[s].name]=a?ut(a):a}return n},ot.prototype.captures=function(t){return this.opts.ignoreCaptures?[]:t.match(this.regexp).slice(1)},ot.prototype.param=function(t,e){var r=this.stack,n=this.paramNames,i=function(r,n){return e.call(this,r.params[t],r,n)};i.param=t;var s=n.map(function(t){return t.name}),a=s.indexOf(t);return a>-1&&r.some(function(t,e){if(!t.param||s.indexOf(t.param)>a)return r.splice(e,0,i),!0}),this},ot.prototype.setPrefix=function(t){return this.path&&(this.path=(t+this.path).replace(/[\/]+/g,"/"),this.paramNames=[],this.regexp=at(this.path,this.paramNames,this.opts)),this},d.forEach(function(t){ct.prototype[t.toLowerCase()]=function(e,r,n){return"string"==typeof r||r instanceof RegExp?n=Array.prototype.slice.call(arguments,2):(n=Array.prototype.slice.call(arguments,1),r=e,e=null),this.register(r,[t.toUpperCase()],n,{name:e}),this}}),ct.prototype.del=ct.prototype.delete,ct.prototype.use=function(){var t,e=this,r=Array.prototype.slice.call(arguments);if(Array.isArray(r[0])&&"string"==typeof r[0][0])return r[0].forEach(function(t){e.use.apply(e,[t].concat(r.slice(1)))}),this;var n="string"==typeof r[0];return n&&(t=r.shift()),r.forEach(function(r){r.router?(r.router.stack.forEach(function(r){t&&r.setPrefix(t),e.opts.prefix&&r.setPrefix(e.opts.prefix),e.stack.push(r)}),e.params&&Object.keys(e.params).forEach(function(t){r.router.param(t,e.params[t])})):e.register(t||"(.*)",[],r,{end:!1,ignoreCaptures:!n})}),this},ct.prototype.prefix=function(t){return t=t.replace(/\/$/,""),this.opts.prefix=t,this.stack.forEach(function(e){e.setPrefix(t)}),this},ct.prototype.routes=ct.prototype.middleware=function(){var t=this,e=function(e,r){var n=t.opts.routerPath||e.routerPath||e.path,i=t.match(n,e.method);if(e.matched?e.matched.push.apply(e.matched,i.path):e.matched=i.path,e.router=t,!i.route)return r();var s=i.pathAndMethod,a=s[s.length-1];return e._matchedRoute=a.path,a.name&&(e._matchedRouteName=a.name),F(s.reduce(function(t,e){return t.push(function(t,r){return t.captures=e.captures(n,t.captures),t.params=e.params(n,t.captures,t.params),t.routerName=e.name,r()}),t.concat(e.stack)},[]))(e,r)};return e.router=this,e},ct.prototype.all=function(t,e,r){return"string"==typeof e?r=Array.prototype.slice.call(arguments,2):(r=Array.prototype.slice.call(arguments,1),e=t,t=null),this.register(e,methods,r,{name:t}),this},ct.prototype.register=function(t,e,r,n){n=n||{};var i=this,s=this.stack;if(Array.isArray(t))return t.forEach(function(t){i.register.call(i,t,e,r,n)}),this;var a=new ot(t,e,r,{end:!1!==n.end||n.end,name:n.name,sensitive:n.sensitive||this.opts.sensitive||!1,strict:n.strict||this.opts.strict||!1,prefix:n.prefix||this.opts.prefix||"",ignoreCaptures:n.ignoreCaptures});return this.opts.prefix&&a.setPrefix(this.opts.prefix),Object.keys(this.params).forEach(function(t){a.param(t,this.params[t])},this),s.push(a),a},ct.prototype.route=function(t){for(var e=this.stack,r=e.length,n=0;n<r;n++)if(e[n].name&&e[n].name===t)return e[n];return!1},ct.prototype.match=function(t,e){for(var r,n=this.stack,i={path:[],pathAndMethod:[],route:!1},s=n.length,a=0;a<s;a++)(r=n[a]).match(t)&&(i.path.push(r),(0===r.methods.length||~r.methods.indexOf(e))&&(i.pathAndMethod.push(r),r.methods.length&&(i.route=!0)));return i},ct.prototype.param=function(t,e){return this.params[t]=e,this.stack.forEach(function(r){r.param(t,e)}),this};var pt=function(){function t(e){i(this,t),this.name=e}return s(t,[{key:"set",value:function(t,e){Reflect.defineMetadata(this.name,e,t)}},{key:"get",value:function(t){return Reflect.getMetadata(this.name,t)}}]),t}(),ft=function(t){function e(){return i(this,e),a(this,u(e).call(this,"Service"))}return h(e,pt),s(e,[{key:"interfaceWillInject",value:function(t,e){var r=this;return function(n,i,s){if(i||s){var a=r.get(s.value);a||(a={}),a[t]=e,r.set(s.value,a)}}}},{key:"interfaceDidRendered",value:function(t,e){var r=e.options,n=e.ctx,i={};for(var s in t)i[s]=new t[s](n),i[s].ctx||Object.defineProperty(i[s],"ctx",{get:function(){return n}});Object.keys(i).length>0&&(r.Service=i)}}]),e}(),lt=function(t){function e(t){var r;i(this,e);var n=new X(t),s=n.render();return r=a(this,u(e).call(this,s.mode||"hash")),v.prototype.$app=o(r),r.$parser=n,r.$router=new ct,r.$env="production",r.$plugin=new J(s.plugin_configs),Object.defineProperty(o(r),"$config",{get:function(){return s.custom_configs}}),n.VueInjectRender(o(r)),r}return h(e,B),s(e,[{key:"$fetch",value:function(){var t=n(r.mark(function t(){var n,i,s,a,o=arguments;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(i=o.length,s=new Array(i),a=0;a<i;a++)s[a]=o[a];return t.next=3,(n=c(u(e.prototype),"fetch",this)).call.apply(n,[this].concat(s));case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"$get",value:function(){var t=n(r.mark(function t(){var n,i,s,a,o=arguments;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(i=o.length,s=new Array(i),a=0;a<i;a++)s[a]=o[a];return t.next=3,(n=c(u(e.prototype),"get",this)).call.apply(n,[this].concat(s));case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"$post",value:function(){var t=n(r.mark(function t(){var n,i,s,a,o=arguments;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(i=o.length,s=new Array(i),a=0;a<i;a++)s[a]=o[a];return t.next=3,(n=c(u(e.prototype),"post",this)).call.apply(n,[this].concat(s));case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"$put",value:function(){var t=n(r.mark(function t(){var n,i,s,a,o=arguments;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(i=o.length,s=new Array(i),a=0;a<i;a++)s[a]=o[a];return t.next=3,(n=c(u(e.prototype),"put",this)).call.apply(n,[this].concat(s));case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"$delete",value:function(){var t=n(r.mark(function t(){var n,i,s,a,o=arguments;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(i=o.length,s=new Array(i),a=0;a<i;a++)s[a]=o[a];return t.next=3,(n=c(u(e.prototype),"delete",this)).call.apply(n,[this].concat(s));case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"$redirect",value:function(){var t=n(r.mark(function t(){var n,i,s,a,o=arguments;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(i=o.length,s=new Array(i),a=0;a<i;a++)s[a]=o[a];return t.next=3,(n=c(u(e.prototype),"redirect",this)).call.apply(n,[this].concat(s));case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"$replace",value:function(){var t=n(r.mark(function t(){var n,i,s,a,o=arguments;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(i=o.length,s=new Array(i),a=0;a<i;a++)s[a]=o[a];return t.next=3,(n=c(u(e.prototype),"replace",this)).call.apply(n,[this].concat(s));case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"$reload",value:function(){var t=n(r.mark(function t(){var n,i,s,a,o=arguments;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(i=o.length,s=new Array(i),a=0;a<i;a++)s[a]=o[a];return t.next=3,(n=c(u(e.prototype),"reload",this)).call.apply(n,[this].concat(s));case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=n(r.mark(function t(e,n){return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.$vue){t.next=2;break}throw this.context.error("Vue is not installed.");case 2:if(e){t.next=4;break}throw this.context.error("webview required.");case 4:return this.$vue.webview=e,this.$vue.props=n,t.next=8,new Promise(function(t){return v.nextTick(t)});case 8:case"end":return t.stop()}},t,this)}));return function(e,r){return t.apply(this,arguments)}}()},{key:"createServer",value:function(){var t=n(r.mark(function t(n){return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$parser.PluginRender(this);case 2:return t.next=4,this.emit("PluginDidInstalled");case 4:return this.$plugin.setDecorate(ft),this.$parser.DecorateRender(this),this.$plugin.renderDecorateIntoInterface(),t.next=9,this.emit("DecorateDidInstalled");case 9:return ht(this,this.$parser.ControllerRender()),t.next=12,this.emit("RouterWillInstall");case 12:return this.use(this.$router.routes()),t.next=15,this.emit("RouterDidInstalled");case 15:return this.$vue=this.$parser.BuildVue(this),t.next=18,this.emit("ServerWillCreate");case 18:return t.next=20,c(u(e.prototype),"createServer",this).call(this,n);case 20:return t.next=22,this.emit("ServerDidCreated");case 22:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()}]),e}();exports.default=lt,exports.Http=y,exports.Interface=m,exports.Controller=function(t){return"function"==typeof t?(Reflect.defineMetadata("Controller","/",t),Reflect.defineMetadata("Index",99,t)):function(e){return Reflect.defineMetadata("Controller",t,e)}},exports.Index=function(t){return function(e,r,n){if(!r&&!n)return Reflect.defineMetadata("Index",t,e)}},exports.Middleware=function(){for(var t=arguments,e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=t[n];return function(t,e,n){if(e||n){var i,s=Reflect.getMetadata("Middleware",t);s||(s=[]),(i=s).unshift.apply(i,r),Reflect.defineMetadata("Middleware",s,n.value)}else{var a,o=Reflect.getMetadata("Middleware",t);o||(o=[]),(a=o).unshift.apply(a,r),Reflect.defineMetadata("Middleware",o,t)}}},exports.Param=function(t){for(var e=arguments,r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=e[i];return function(e,r,i){if(!r&&!i){var s=Reflect.getMetadata("Param",e);s||(s=[]),s.push({id:t,middlewares:n}),Reflect.defineMetadata("Param",s,e)}}};